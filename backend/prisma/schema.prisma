generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Status: DRAFT, SENT, SIGNED, COMPLETED
// ContractType: REGULAR, PARTTIME, DAILY
// UserRole: COMPANY_ADMIN, COMPANY_USER

model User {
  id          String   @id @default(uuid())
  email       String   @unique
  password    String   // bcrypt 해시
  role        String   @default("COMPANY_ADMIN")
  companyId   String
  company     Company  @relation(fields: [companyId], references: [id])
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Company {
  id              String     @id @default(uuid())
  name            String     // 회사명
  ceoName         String     // 대표자명
  businessNumber  String     @unique // 사업자등록번호 (000-00-00000)
  address         String
  phone           String
  status          String     @default("ACTIVE")
  users           User[]
  contracts       Contract[]
  createdAt       DateTime   @default(now())
  updatedAt       DateTime   @updatedAt
}

model Contract {
  id              String    @id @default(uuid())
  status          String    @default("DRAFT")
  contractType    String    // REGULAR, PARTTIME, DAILY

  // 회사 연결
  companyId       String?
  company         Company?  @relation(fields: [companyId], references: [id])

  // 고용주 정보
  employerName    String    // 상호명
  employerCeo     String    // 대표자명
  employerAddress String    // 사업장 주소
  employerPhone   String    // 연락처

  // 근로자 정보
  workerName      String    // 이름
  workerBirth     String    // 생년월일
  workerPhone     String    // 연락처
  workerAddress   String    // 주소

  // 근무 조건
  startDate       DateTime  // 계약 시작일
  endDate         DateTime? // 계약 종료일 (null이면 무기한)
  workDays        String    // 근무 요일 JSON ["월","화","수"]
  workStart       String    // 근무 시작 시간 "09:00"
  workEnd         String    // 근무 종료 시간 "18:00"
  breakTime       Int       // 휴게 시간 (분 단위)
  hourlyWage      Int       // 시급
  payDay          Int       // 급여 지급일 (매월 N일)

  // 특약 사항
  specialTerms    String?

  // 서명 데이터 (Base64 이미지)
  employerSign    String?
  workerSign      String?

  // 블록체인 관련
  pdfHash         String?   // PDF SHA-256 해시
  solanaTxId      String?   // Solana 트랜잭션 ID

  // 타임스탬프
  createdAt       DateTime  @default(now())
  updatedAt       DateTime  @updatedAt
  signedAt        DateTime? // 양측 서명 완료 시점
}
